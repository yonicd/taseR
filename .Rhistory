data.frame(season=c(1998:2004),conc=c(56,88,66,109,96,72,72))%>%mutate(play.time=1230*60)%>%mutate(conc.100.minute=100*conc/play.time)
data.frame(season=c(1998:2004),conc=c(56,88,66,109,96,72,72))%>%mutate(play.time=1230*60)%>%mutate(conc.100.minute=60*conc/play.time)
data.frame(season=c(1998:2004),conc=c(56,88,66,109,96,72,72))%>%mutate(play.time=1230*60)%>%
mutate(conc.hr=60*conc/play.time)%>%summarise(sum(conc.hr))
12+3+12+12+25+18+28+8
data.frame(season=c(1998:2004,2011:2012),conc=c(56,88,66,109,96,72,72,98,118))%>%mutate(play.time=1230*60)%>%
mutate(conc.hr=60*conc/play.time)%>%summarise(sum(conc.hr))
data.frame(season=c(1998:2004,2011:2012),conc=c(56,88,66,109,96,72,72,98,118))%>%mutate(play.time=1230*60)%>%
mutate(conc.hr=60*conc/play.time)
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012")
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012.csv")
View(nfl_2010_2012)
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012.csv")
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012.csv",check.names = F)
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012.csv",check.names = F)%>%melt(.,id=c("team","season.type"),variable.name="season",value.name="conc")
library(rvest)
conc.team=mdply(c(2012:2014),.fun = function(yr){
y=html(paste0('C:\\Users\\yoni\\Dropbox\\NFL\\pbs_',yr,'.html'))%>%
html_nodes(xpath="//div[@id='mainarea']")%>%html_nodes("p")%>%html_text
yout=data.frame(team=y[seq(0,64,2)],conc=as.numeric(y[seq(1,64,2)]))%>%mutate(season=yr)
return(yout)})
conc.team$X1=NULL
conc.team$team[which(is.na(conc.team$team))]=c("Bills","Dolphins")
conc.team$conc[which(is.na(conc.team$conc))]=0
View(conc.team)
View(nfl_2010_2012)
conc.team=mdply(c(2013:2014),.fun = function(yr){
y=html(paste0('C:\\Users\\yoni\\Dropbox\\NFL\\pbs_',yr,'.html'))%>%
html_nodes(xpath="//div[@id='mainarea']")%>%html_nodes("p")%>%html_text
yout=data.frame(team=y[seq(0,64,2)],conc=as.numeric(y[seq(1,64,2)]))%>%mutate(season=yr)
return(yout)})
conc.team$X1=NULL
which(is.na(conc.team$team))
conc.team$team[which(is.na(conc.team$team))]=c("Bills","Dolphins")
conc.team$conc[which(is.na(conc.team$conc))]=0
unique(conc.team$team)
View(unique(conc.team$team))
nfl_2010_2012=read.csv("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_2010_2012.csv",check.names = F)%>%melt(.,id=c("team","season.type"),variable.name="season",value.name="conc")
View(nfl_2010_2012)
rbind(nfl_2010_2012%>%filter(season.type=="Regular")%>%select(-season.type),con.team)
rbind(nfl_2010_2012%>%filter(season.type=="Regular")%>%select(-season.type),conc.team)
class(conc.team$season)
class(nfl_2010_2012$season)
nfl_2010_2012$season=as.numeric(as.character(nfl_2010_2012$season))
rbind(nfl_2010_2012%>%filter(season.type=="Regular")%>%select(-season.type),conc.team)
conc.team=rbind(nfl_2010_2012%>%filter(season.type=="Regular")%>%select(-season.type),conc.team)
load("C:\\Users\\yoni\\Dropbox\\NFL\\gamedata.rdata")
load("C:\\Users\\yoni\\Dropbox\\NFL\\nfl_injury_data.rdata")
nfl=x1%>%filter(var=="Total Plays")%>%
mutate(value=as.numeric(value),play.time=value*4/60,season=factor(season))%>%
arrange(team,date)
y=nfl%>%count(season,team)%>%group_by(team,season)%>%do(.,data.frame(week=seq(1,.$n)))
nfl$week=y$week
nfl=left_join(nfl,nfl%>%group_by(url)%>%summarise(play.time.total=sum(play.time)),
by="url")
left_join(nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc)%>%mutate(season=factor(season)),
by="season")%>%
mutate(conc.hr=conc/play.time)
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time)
conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc)%>%mutate(season=factor(season))
left_join(conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc)%>%mutate(season=factor(season)),
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
by="season")%>%
mutate(conc.hr=conc/play.time)
nfl=x1%>%filter(var=="Total Plays")%>%
mutate(value=as.numeric(value),play.time=value*4/60)%>%
arrange(team,date)
y=nfl%>%count(season,team)%>%group_by(team,season)%>%do(.,data.frame(week=seq(1,.$n)))
nfl$week=y$week
nfl=left_join(nfl,nfl%>%group_by(url)%>%summarise(play.time.total=sum(play.time)),
by="url")
left_join(conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc)),
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
by="season")%>%
mutate(conc.hr=conc/play.time)
left_join(conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc),
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
by="season")%>%
mutate(conc.hr=conc/play.time)
x0=mdply(c(2010:2011),.fun = function(s){
url=paste0("http://www.pro-football-reference.com/years/",s,"/games.htm")
tableNodes = getNodeSet(htmlParse(url), "//table")
x<-xpathSApply(tableNodes[[1]],'/.a',xmlAttrs)
x=sapply(x,'[[',1)
x=x[which(str_detect(x,glob2rx("/boxscores*.htm")))]
x=data.frame(url=x)%>%mutate(season=s)
return(x)}
)
x0$X1=NULL
x0=mdply(c(2010:2011),.fun = function(s){
url=paste0("http://www.pro-football-reference.com/years/",s,"/games.htm")
tableNodes = getNodeSet(htmlParse(url), "//table")
x<-xpathSApply(tableNodes[[1]],'/a',xmlAttrs)
x=sapply(x,'[[',1)
x=x[which(str_detect(x,glob2rx("/boxscores*.htm")))]
x=data.frame(url=x)%>%mutate(season=s)
return(x)}
)
x0$X1=NULL
x0=mdply(c(2010:2011),.fun = function(s){
url=paste0("http://www.pro-football-reference.com/years/",s,"/games.htm")
tableNodes = getNodeSet(htmlParse(url), "//table")
x<-xpathSApply(tableNodes[[1]],'//a',xmlAttrs)
x=sapply(x,'[[',1)
x=x[which(str_detect(x,glob2rx("/boxscores*.htm")))]
x=data.frame(url=x)%>%mutate(season=s)
return(x)}
)
x0$X1=NULL
View(x0)
x=rbind(x0,x)
rm(x0)
View(x)
x2=ddply(x%>%filter(season%in%c(2010,2011)),.(season,url),.fun=function(xin){
url=paste0("http://www.pro-football-reference.com/",xin$url)
tableNodes = getNodeSet(htmlParse(url), "//table[@id='team_stats']")
y=readHTMLTable(tableNodes[[1]],as.data.frame=T)
names(y)[1]="var"
yout=tail(y,2)%>%melt(.,id="var",variable.name="team")%>%
mutate(date=as.Date(str_sub(str_replace_all(xin$url,"[a-z./]",""),1,-2),"%Y%m%d"),
url=as.character(xin$url))
return(yout)},.progress = "text")
x1=rbind(x2,x1)
nfl=x1%>%filter(var=="Total Plays")%>%
mutate(value=as.numeric(value),play.time=value*4/60)%>%
arrange(team,date)
y=nfl%>%count(season,team)%>%group_by(team,season)%>%do(.,data.frame(week=seq(1,.$n)))
nfl$week=y$week
nfl=left_join(nfl,nfl%>%group_by(url)%>%summarise(play.time.total=sum(play.time)),
by="url")
left_join(conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc),
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
by="season")%>%
mutate(conc.hr=conc/play.time)
left_join(conc.team%>%group_by(season)%>%summarise_each(funs(sum),conc),
nfl%>%group_by(season)%>%summarise_each(funs(sum),value,play.time),
by="season")%>%
mutate(conc.hr=60*conc/play.time)
rm(x2)
save(x,x1,file="C:\\Users\\yoni\\Dropbox\\NFL\\nfl_injury_data.rdata")
nfl_2010_2012%>%group_by(season)%>%summarise(sum(conc))
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$name=sapply(str_split(x$x,"_"),'[',1)
x$version=sapply(str_split(x$x,"_"),'[',2)
x$version=str_replace_all(x$version,"-",".")
library(stringr)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$name=sapply(str_split(x$x,"_"),'[',1)
x$version=sapply(str_split(x$x,"_"),'[',2)
x$version=str_replace_all(x$version,"-",".")
a=available.packages()
dim(a)
a=as.data.frame(available.packages())
View(a)
View(x)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$package=sapply(str_split(x$x,"_"),'[',1)
x$version=sapply(str_split(x$x,"_"),'[',2)
x$version=str_replace_all(x$version,"-",".")
View(x)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$package=sapply(str_split(x$x,"_"),'[',1)
x$version.current=sapply(str_split(x$x,"_"),'[',2)
x$version.current=str_replace_all(x$version.current,"-",".")
View(x)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$package=sapply(str_split(x$x,"_"),'[',1)
x$version.current=sapply(str_split(x$x,"_"),'[',2)
library(dplyr)
x1=left_join(x%>%select(package,version.current),a%>%select(package,version),by="package")
names(a)
x1=left_join(x%>%select(package,version.current),a%>%select(package=Package,version),by="package")
x1=left_join(x%>%select(package,version.current),a%>%select(package=Package,version=Version),by="package")
View(x1)
x1=left_join(a%>%select(package=Package,version=Version),x%>%select(package,version.current),by="package")
View(x1)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x$Version=str_replace_all(x$Version,"-",".")
x1=left_join(a%>%select(Package,Version),x%>%select(Package,Version),by=c("Package","Version"))
View(x1)
x1=left_join(a%>%select(Package,Version),x%>%select(Package,Version)%>%mutate(x=1),by=c("Package","Version"))
View(x1)
x1=anti_join(a%>%select(Package,Version),x%>%select(Package,Version)%>%mutate(x=1),by=c("Package","Version"))
View(x1)
x1=anti_join(x%>%select(Package,Version),a%>%select(Package,Version),by=c("Package","Version"))
x1=semi_join(x%>%select(Package,Version),a%>%select(Package,Version),by=c("Package","Version"))
View(x1)
x1=semi_join(a%>%select(Package,Version),x%>%select(Package,Version),by=c("Package","Version"))
x1=inner_join(a%>%select(Package,Version),x%>%select(Package,Version),by=c("Package","Version"))
x1=anti_join(a%>%select(Package,Version),x%>%select(Package,Version),by=c("Package","Version"))
View(x1)
View(x)
View(a)
x1=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
View(x1)
download.packages(x1$Package[1],"c:\\r\\new\\")
download.packages(x1$Package[c(2,3)],"c:\\r\\new\\")
nrow(x1)
4:6/nrow(x1)
b=4:6
4:6/max(b)
pb <- txtProgressBar(...)
pb <- txtProgressBar()
for(i in 4:6/max(b)){
out=download.packages(x1$Package[i],"c:\\r\\new\\")
setTxtProgressBar(pb, i)
}
close(pb)
b=7:20
pb <- txtProgressBar(initial = 7,max=10)
for(i in b){
out=download.packages(x1$Package[i],"c:\\r\\new\\")
setTxtProgressBar(pb, i)
}
b
b=20:30
b=20:30
pb <- txtProgressBar(initial = min(b),min=min(b),max=max(b))
for(i in b){
out=download.packages(x1$Package[i],"c:\\r\\new\\")
setTxtProgressBar(pb = pb, value = i)
}
close(pb)
b=30:50
pb <- txtProgressBar(initial = min(b),min=min(b),max=max(b))
for(i in b){
out=download.packages(x1$Package[i],"c:\\r\\new\\")
setTxtProgressBar(pb = pb, value = i)
}
close(pb)
out=download.packages(x1$Package[-c(1:50)],"c:\\r\\new\\")
x=list.files("c:\\r\\new\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x1=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
x.new=x
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x=rbind(x,x.new)
x=distinct(x)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x2=rbind(x,x.new)
x3=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
rm(x2,x3)
View(x.new)
View(a)
a$file=paste0(paste(a$Package,a$Version,sep="_"),".zip)
a$file=paste0(paste(a$Package,a$Version,sep="_"),".zip")
View(a)
View(x.new)
a$file%in%x.new$file
x.new$file%in%a$file
which(!x.new$file%in%a$file)
View(x1)
x1$file=paste0(paste(x1$Package,x1$Version,sep="_"),".zip")
which(!x.new$file%in%x1$file)
which(x.new$file%in%x1$file)
which(x1$file%in%x.new$file)
x1=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
x1=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
x=list.files("c:\\r\\all\\")
x0==list.files("c:\\r\\new\\")
x0=list.files("c:\\r\\new\\")
x=c(x,x0)
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x$Version=str_replace_all(x$Version,"-",".")
x1=x%>%group_by(Package)%>%do(.,head(.,1))
x2=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
View(x2)
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x$Version=str_replace_all(x$Version,"-",".")
x1=x%>%group_by(Package)%>%do(.,head(.,-1))
x=list.files("c:\\r\\all\\")
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x1=x%>%group_by(Package)%>%do(.,head(.,-1))
a=available.packages()
a=as.data.frame(available.packages())
x1=anti_join(a,x%>%select(Package,Version),by=c("Package","Version"))
x1$Package[-c(1:50)]
x=list.files("c:\\r\\all\\")
x0=list.files("c:\\r\\new\\")
x=c(x,x0)
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=str_replace_all(x$Version,"-",".")
x$Version=sapply(str_split(x$x,"_"),'[',2)
x=data.frame(file=x,x=gsub(".zip","",x))
x=list.files("c:\\r\\all\\")
x0=list.files("c:\\r\\new\\")
x=c(x,x0)
x=data.frame(file=x,x=gsub(".zip","",x))
x$Package=sapply(str_split(x$x,"_"),'[',1)
x$Version=sapply(str_split(x$x,"_"),'[',2)
x$Version=str_replace_all(x$Version,"-",".")
x1=x%>%group_by(Package)%>%do(.,head(.,-1))
View(x1)
View(x)
x2=x%>%group_by(Package)%>%do(.,head(.,1))
rm(list=ls())
library(gtools)
install.packages("gtools")
library(gtools)
getDependencies("dplyr")
library(tools)
write_PACKAGES("C:\\R\\dplyr")
install.packages("dplyr",contriburl="file:///c:/r/dplyr/")
install.packages("dplyr",contriburl="file:////READYSHARE/USB_Storage/R/dplyr/")
install.packages("PerformanceAnalytics")
library("PerformanceAnalytics", lib.loc="~/R/win-library/3.2")
setwd("C:\\Users\\yoni\\Documents\\GitHub\\tase")
stockID=read.csv("stockID.csv")
library(lubridate)
library(XML)
library(plyr)
library(dplyr)
library(RSelenium)
source("call_tase.r");source("call_tase_index.r");source("call_tase_index_intraday.r");source("call_tase_index_components.r")
system("phantomjs.exe get_tase.js")
system("phantomjs.exe get_tase.js")
system("phantomjs.exe get_tase.js")
system("phantomjs.exe get_tase.js")
system("phantomjs.exe get_tase.js")
system("phantomjs.exe get_tase.js")
cID='000281'
sID='00281014'
From.Date = format(Sys.Date()-months(3),"%d/%m/%Y")
To.Date=format(Sys.Date(),"%d/%m/%Y")
Dtype='0'
Freq="daily"
intraday=F
if(cID!=''&sID!='')  tase.security(companyID=cID,shareID=sID,From.Date,To.Date,subDataType=Dtype,Freq)
system("phantomjs.exe get_tase.js")
indexID='137'
tase.index(indexID,From.Date,To.Date,Freq)
system("phantomjs.exe get_tase.js")
tase.index.intraday(indexID,From.Date,To.Date)
system("phantomjs.exe get_tase.js")
source('~/GitHub/tase/call_tase_security_otc.r', echo=TRUE)
tase.security.otc(companyID=cID,shareID=sID,From.Date,To.Date)
system("phantomjs.exe get_tase.js")
source('~/GitHub/tase/call_tase_security_intraday.r', echo=TRUE)
tase.security.intraday(companyID=cID,shareID=sID)
system("phantomjs.exe get_tase.js")
paste0("http://www.tase.co.il/Eng/general/company/Pages/companyHistoryData.aspx?",
"subDataType=",subDataType,
"&shareID=",shareID,"&bondType=")
subDataType=5
paste0("http://www.tase.co.il/Eng/general/company/Pages/companyHistoryData.aspx?",
"subDataType=",subDataType,
"&shareID=",shareID,"&bondType=")
shareID='08151011'
paste0("http://www.tase.co.il/Eng/general/company/Pages/companyHistoryData.aspx?",
"subDataType=",subDataType,
"&shareID=",shareID,"&bondType=")
z <- strptime("2010-01-15 13:55:23.975", "%Y-%m-%d %H:%M:%OS")
z # prints without fractional seconds
op <- options(digits.secs=3)
z
options(op)
strptime(time[1], "%OS3")
time
time()
time[1]
time[z]
system.time()
date()
time[date()]
strptime(date(), "%OS3")
strptime(date(), "%OS")
strptime(date(), "%OS1")
strptime(date(), "%OSn")
strptime(date(), "%OS2")
op <- options(digits.secs=3)
strptime(date(), "%OS")
strptime(date(), "%OS")
options(op)
op <- options(digits.secs=3)
z <- strptime("2010-01-15 13:55:23.975", "%Y-%m-%d %H:%M:%OS")
z
op <- options(digits.secs=6)
z
z <- strptime("2010-01-15 13:55:23.975234", "%Y-%m-%d %H:%M:%OS")
z
op <- options(digits.secs=3)
z
as.Date("2015-04-21")
date()-as.Date("2015-04-21")
as.Date(date())-as.Date("2015-04-21")
Sys.Date()-as.Date("2015-04-21")
24*60*Sys.Date()-as.Date("2015-04-21")
24*60*(Sys.Date()-as.Date("2015-04-21"))
24*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
6*1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
635651712000000000-1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
63565171200-1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
635651712-1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
6356517120-1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-03-16"))
1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
b=1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
a=1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-03-16"))
a-b
(a-b)/(1000*24*60*60)
as.Date("2015-04-21")-as.Date("2015-03-16")
635651712000000000-635620608000000000
635651712-635620608
635651712/(1000*24*60*60)
635620608/(1000*24*60*60)
63565171200000-63562060800000
(a-b)
63565171200000/(1000*24*60*60)
63562060800000/(1000*24*60*60)
as.Date("2015-04-21")-735708
1000*24*60*60*as.numeric(Sys.Date()-as.Date("1970-01-01"))
options(scipen=999)
1000*24*60*60*as.numeric(Sys.Date()-as.Date("1970-01-01"))
1000*24*60*60*as.numeric(Sys.Date()-as.Date("2015-04-21"))
1430697600000+1123200000
as.Date("2015-04-21")-735708
as.Date("2015-04-21")-735702
as.Date("2015-04-21")-735708
as.Date("0001-01-01")
as.Date("2015-03-16")-as.Date("0001-01-01")
(1000*24*60*60)*(as.Date("2015-03-16")-as.Date("0001-01-01"))
(1000*24*60*60)*as.numeric((as.Date("2015-03-16")-as.Date("0001-01-01")))
1e8*(24*6*6)*as.numeric((as.Date("2015-03-16")-as.Date("0001-01-01")))
1e9*(24*6*6)*as.numeric((as.Date("2015-03-16")-as.Date("0001-01-01")))
1e9*(24*6*6)*as.numeric((as.Date("2015-03-15")-as.Date("0001-01-01")))
1e9*(24*6*6)*as.numeric((as.Date("2015-02-15")-as.Date("0001-01-01")))
readHTMLTable("http://www.tase.co.il/Eng/Management/GeneralPages/Pages/GridOnSeparatePage.aspx?Action=1&subDataType=2&IndexId=142&day=1&GridId=98&CurGuid={F9AF0818-85CC-43D3-AE34-76D89C0EB977}",header = T)
From.Date
date.url=1e9*(24*6*6)*as.numeric((From.Date-as.Date("0001-01-01")))
date.url=1e9*(24*6*6)*as.numeric((as.Date(From.Date)-as.Date("0001-01-01")))
url=paste0("http://www.tase.co.il/Eng/Management/GeneralPages/Pages/GridOnSeparatePage.aspx?Action=1&subDataType=2&IndexId=",indexID,"&day=3&date=",date.url,"&GridId=143&CurGuid={F9AF0818-85CC-43D3-AE34-76D89C0EB977}")
writeLines(sprintf("var page = require('webpage').create();
var fs = require('fs');
var path = 'tase_out_popup.html';
var webPAgeAddress  = '%s';
page.open(webPAgeAddress , function (status) {
var content = page.content;
fs.write(path,content,'w') ;
phantom.exit();
});",url),con="get_tase.js")}
source('~/GitHub/tase/call_tase_index_components.r', echo=TRUE)
tase.index.component(indexID,From.Date)
system("phantomjs.exe get_tase.js")
indexID="142"
tase.index.component(indexID,From.Date)
system("phantomjs.exe get_tase.js")
source('~/GitHub/tase/call_tase_index_components.r', echo=TRUE)
From.Date="2015-02-15"
tase.index.component(indexID,From.Date)
system("phantomjs.exe get_tase.js")
data.frame(indexName=c('TA25','TA100'),
indexID=c('142','137'),
indexCode=c('{F9AF0818-85CC-43D3-AE34-76D89C0EB977}','{F9AF0818-85CC-43D3-AE34-76D89C0EB977}'))
IndexDic=data.frame( indexName=c('TA25','TA100','TA75'),
indexID=c('142','137','143'),
indexCode=c('{F9AF0818-85CC-43D3-AE34-76D89C0EB977}',
'{F9AF0818-85CC-43D3-AE34-76D89C0EB977}',
'{F9AF0818-85CC-43D3-AE34-76D89C0EB977}',
))
IndexDic=data.frame( indexName=c('TA25','TA100','TA75'),
indexID=c('142','137','143'),
indexCode=c('{F9AF0818-85CC-43D3-AE34-76D89C0EB977}',
'{F9AF0818-85CC-43D3-AE34-76D89C0EB977}',
'{F9AF0818-85CC-43D3-AE34-76D89C0EB977}'
))
IndexDic$indexID%in%indexID
which(IndexDic$indexID%in%indexID)
IndexDic$indexCode[which(IndexDic$indexID%in%indexID)]
url=paste0("http://www.tase.co.il/Eng/Management/GeneralPages/Pages/GridOnSeparatePage.aspx?Action=1&subDataType=2&
IndexId=",indexID,
"&day=3&date=",date.url,
"&GridId=143&CurGuid=",IndexDic$indexCode[which(IndexDic$indexID%in%indexID)])
url
url=paste0("http://www.tase.co.il/Eng/Management/GeneralPages/Pages/GridOnSeparatePage.aspx?Action=1&subDataType=2&IndexId=",indexID,
"&day=3&date=",date.url,
"&GridId=143&CurGuid=",IndexDic$indexCode[which(IndexDic$indexID%in%indexID)])
url
url=paste0("http://www.tase.co.il/Eng/Management/GeneralPages/Pages/GridOnSeparatePage.aspx?Action=1&subDataType=2&IndexId=",indexID,
"&day=3&date=",date.url,
"&GridId=143&CurGuid={F9AF0818-85CC-43D3-AE34-76D89C0EB977}")
url
indexID="143"
source('~/GitHub/tase/call_tase_index_components.r', echo=TRUE)
tase.index.component(indexID,From.Date)
system("phantomjs.exe get_tase.js")
